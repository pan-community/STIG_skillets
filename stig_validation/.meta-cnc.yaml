name: stig_validation
label: STIG Validation
description: Validates a NGFW configuration for STIG Compliance
type: pan_validation
labels:
    collection: STIG
variables:
-   name: dos_strategy
    type_hint: dropdown
    description: DoS Strategy
    default: zone
    help_text: ''
    dd_list:
    -   key: Zone Protection Profiles
        value: zone
    -   key: Dos Protection Profiles
        value: dos
-   name: internal_zone
    type_hint: text
    description: Internal Zone
    default: internal
    help_text: ''
snippets:
-   name: parse-01
    cmd: parse
    test: 'true'
    severity: low
    variable: config
    outputs:
    -   name: zones_with_protection_profiles
        capture_value: /config/devices/entry[@name="localhost.localdomain"]/vsys/entry[@name="vsys1"]/zone/entry/network/zone-protection-profile/../../@name
    -   name: zone_protection_profiles
        capture_list: /config/devices/entry[@name="localhost.localdomain"]/network/profiles/zone-protection-profile/entry/@name
    fail_message: Snippet Validation Failed
    pass_message: Snippet Validation Passed
-   cmd: validate
    documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2019-12-20/finding/V-62601
    fail_message: fail
    label: The Palo Alto Networks security platform must protect against Denial of
        Service (DoS) attacks by employing rate-based attack prevention behavior analysis
        (traffic thresholds).
    name: V-62601
    output_type: validation
    pass_message: pass
    severity: high
    tags:
    - stig_alg
    test: |-
        (
        zone_protection_profiles | length
        and internal_zone in zones_with_protection_profiles
        )
    when: 'true'
-   cmd: validate
    documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2019-12-20/finding/V-62547
    fail_message: fail
    label: The Palo Alto Networks security platform, if used to provide intermediary
        services for remote access communications traffic (TLS or SSL decryption),
        must ensure inbound and outbound traffic is monitored for compliance with
        remote access security policies.
    name: V-62547
    output_type: validation
    pass_message: pass
    severity: medium
    tags:
    - stig_alg
    test: 'true'
    when: 'true'
-   cmd: validate
    documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2019-12-20/finding/V-62549
    fail_message: fail
    label: The Palo Alto Networks security platform, if used as a TLS gateway/decryption
        point or VPN concentrator, must use encryption services that implement NIST
        FIPS-validated cryptography to protect the confidentiality of remote access
        sessions.
    name: V-62549
    output_type: validation
    pass_message: pass
    severity: medium
    tags:
    - stig_alg
    test: 'true'
    when: 'true'
-   cmd: validate
    documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2019-12-20/finding/V-62551
    fail_message: fail
    label: The Palo Alto Networks security platform that stores secret or private
        keys must use FIPS-approved key management technology and processes in the
        production and control of private/secret cryptographic keys.
    name: V-62551
    output_type: validation
    pass_message: pass
    severity: medium
    tags:
    - stig_alg
    test: 'true'
    when: 'true'
-   cmd: validate
    documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2019-12-20/finding/V-62553
    fail_message: fail
    label: The Palo Alto Networks security platform, if used as a TLS gateway/decryption
        point or VPN concentrator, must use NIST FIPS-validated cryptography to protect
        the integrity of remote access sessions.
    name: V-62553
    output_type: validation
    pass_message: pass
    severity: medium
    tags:
    - stig_alg
    test: 'true'
    when: 'true'
-   cmd: validate
    documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2019-12-20/finding/V-62555
    fail_message: fail
    label: The Palo Alto Networks security platform must log violations of security
        policies.
    name: V-62555
    output_type: validation
    pass_message: pass
    severity: low
    tags:
    - stig_alg
    test: 'true'
    when: 'true'
-   cmd: validate
    documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2019-12-20/finding/V-62557
    fail_message: fail
    label: The Palo Alto Networks security platform must only enable User-ID on trusted
        zones.
    name: V-62557
    output_type: validation
    pass_message: pass
    severity: medium
    tags:
    - stig_alg
    test: 'true'
    when: 'true'
-   cmd: validate
    documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2019-12-20/finding/V-62559
    fail_message: fail
    label: The Palo Alto Networks security platform must disable WMI probing if it
        is not used.
    name: V-62559
    output_type: validation
    pass_message: pass
    severity: medium
    tags:
    - stig_alg
    test: 'true'
    when: 'true'
-   cmd: validate
    documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2019-12-20/finding/V-62561
    fail_message: fail
    label: The Palo Alto Networks security platform must not enable the DNS proxy.
    name: V-62561
    output_type: validation
    pass_message: pass
    severity: medium
    tags:
    - stig_alg
    test: 'true'
    when: 'true'
-   cmd: validate
    documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2019-12-20/finding/V-62563
    fail_message: fail
    label: The Palo Alto Networks security platform must be configured to prohibit
        or restrict the use of functions, ports, protocols, and/or services, as defined
        in the PPSM CAL and vulnerability assessments.
    name: V-62563
    output_type: validation
    pass_message: pass
    severity: medium
    tags:
    - stig_alg
    test: 'true'
    when: 'true'
-   cmd: validate
    documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2019-12-20/finding/V-62565
    fail_message: fail
    label: The Palo Alto Networks security platform that provides intermediary services
        for TLS must validate certificates used for TLS functions by performing RFC
        5280-compliant certification path validation.
    name: V-62565
    output_type: validation
    pass_message: pass
    severity: medium
    tags:
    - stig_alg
    test: 'true'
    when: 'true'
-   cmd: validate
    documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2019-12-20/finding/V-62567
    fail_message: fail
    label: The Palo Alto Networks security platform must protect against the use of
        internal systems from launching Denial of Service (DoS) attacks against other
        networks or endpoints.
    name: V-62567
    output_type: validation
    pass_message: pass
    severity: medium
    tags:
    - stig_alg
    test: 'true'
    when: 'true'
-   cmd: validate
    documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2019-12-20/finding/V-62569
    fail_message: fail
    label: The Palo Alto Networks security platform must block phone home traffic.
    name: V-62569
    output_type: validation
    pass_message: pass
    severity: medium
    tags:
    - stig_alg
    test: 'true'
    when: 'true'
-   cmd: validate
    documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2019-12-20/finding/V-62571
    fail_message: fail
    label: The Palo Alto Networks security platform must deny outbound IP packets
        that contain an illegitimate address in the source address field.
    name: V-62571
    output_type: validation
    pass_message: pass
    severity: medium
    tags:
    - stig_alg
    test: 'true'
    when: 'true'
-   cmd: validate
    documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2019-12-20/finding/V-62573
    fail_message: fail
    label: The Palo Alto Networks security platform must deny network communications
        traffic by default and allow network communications traffic by exception (i.e.,
        deny all, permit by exception).
    name: V-62573
    output_type: validation
    pass_message: pass
    severity: medium
    tags:
    - stig_alg
    test: 'true'
    when: 'true'
-   cmd: validate
    documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2019-12-20/finding/V-62575
    fail_message: fail
    label: The Palo Alto Networks security platform must terminate communications
        sessions after 15 minutes of inactivity.
    name: V-62575
    output_type: validation
    pass_message: pass
    severity: medium
    tags:
    - stig_alg
    test: 'true'
    when: 'true'
-   cmd: validate
    documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2019-12-20/finding/V-62577
    fail_message: fail
    label: The Palo Alto Networks security platform must update malicious code protection
        mechanisms and signature definitions whenever new releases are available in
        accordance with organizational configuration management policy and procedures.
    name: V-62577
    output_type: validation
    pass_message: pass
    severity: medium
    tags:
    - stig_alg
    test: 'true'
    when: 'true'
-   cmd: validate
    documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2019-12-20/finding/V-62579
    fail_message: fail
    label: The Palo Alto Networks security platform must drop malicious code upon
        detection.
    name: V-62579
    output_type: validation
    pass_message: pass
    severity: medium
    tags:
    - stig_alg
    test: 'true'
    when: 'true'
-   cmd: validate
    documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2019-12-20/finding/V-62581
    fail_message: fail
    label: The Palo Alto Networks security platform must delete or quarantine malicious
        code in response to malicious code detection.
    name: V-62581
    output_type: validation
    pass_message: pass
    severity: medium
    tags:
    - stig_alg
    test: 'true'
    when: 'true'
-   cmd: validate
    documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2019-12-20/finding/V-62583
    fail_message: fail
    label: The Palo Alto Networks security platform must automatically update malicious
        code protection mechanisms.
    name: V-62583
    output_type: validation
    pass_message: pass
    severity: medium
    tags:
    - stig_alg
    test: 'true'
    when: 'true'
-   cmd: validate
    documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2019-12-20/finding/V-62585
    fail_message: fail
    label: The Palo Alto Networks security platform must deny or restrict detected
        prohibited mobile code.
    name: V-62585
    output_type: validation
    pass_message: pass
    severity: medium
    tags:
    - stig_alg
    test: 'true'
    when: 'true'
-   cmd: validate
    documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2019-12-20/finding/V-62587
    fail_message: fail
    label: The Palo Alto Networks security platform must prevent the download of prohibited
        mobile code.
    name: V-62587
    output_type: validation
    pass_message: pass
    severity: medium
    tags:
    - stig_alg
    test: 'true'
    when: 'true'
-   cmd: validate
    documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2019-12-20/finding/V-62589
    fail_message: fail
    label: The Palo Alto Networks security platform, if used as a TLS gateway/decryption
        point or VPN concentrator, must control remote access methods (inspect and
        filter traffic).
    name: V-62589
    output_type: validation
    pass_message: pass
    severity: medium
    tags:
    - stig_alg
    test: 'true'
    when: 'true'
-   cmd: validate
    documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2019-12-20/finding/V-62591
    fail_message: fail
    label: The Palo Alto Networks security, if used as a TLS gateway/decryption point
        or VPN concentrator, must provide the capability to immediately disconnect
        or disable remote access to the information system.
    name: V-62591
    output_type: validation
    pass_message: pass
    severity: medium
    tags:
    - stig_alg
    test: 'true'
    when: 'true'
-   cmd: validate
    documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2019-12-20/finding/V-62593
    fail_message: fail
    label: To protect against data mining, the Palo Alto Networks security platform
        must detect and prevent SQL and other code injection attacks launched against
        data storage objects, including, at a minimum, databases, database records,
        queries, and fields.
    name: V-62593
    output_type: validation
    pass_message: pass
    severity: medium
    tags:
    - stig_alg
    test: 'true'
    when: 'true'
-   cmd: validate
    documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2019-12-20/finding/V-62595
    fail_message: fail
    label: To protect against data mining, the Palo Alto Networks security platform
        must detect and prevent code injection attacks launched against application
        objects including, at a minimum, application URLs and application code.
    name: V-62595
    output_type: validation
    pass_message: pass
    severity: medium
    tags:
    - stig_alg
    test: 'true'
    when: 'true'
-   cmd: validate
    documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2019-12-20/finding/V-62597
    fail_message: fail
    label: The Palo Alto Networks security platform must off-load audit records onto
        a different system or media than the system being audited.
    name: V-62597
    output_type: validation
    pass_message: pass
    severity: medium
    tags:
    - stig_alg
    test: 'true'
    when: 'true'
-   cmd: validate
    documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2019-12-20/finding/V-62599
    fail_message: fail
    label: The Palo Alto Networks security platform being used for TLS/SSL decryption
        using PKI-based user authentication must only accept end entity certificates
        issued by DoD PKI or DoD-approved PKI Certificate Authorities (CAs) for the
        establishment of protected sessions.
    name: V-62599
    output_type: validation
    pass_message: pass
    severity: medium
    tags:
    - stig_alg
    test: 'true'
    when: 'true'
-   cmd: validate
    documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2019-12-20/finding/V-62603
    fail_message: fail
    label: The Palo Alto Networks security platform must use a Vulnerability Protection
        Profile that blocks any critical, high, or medium threats.
    name: V-62603
    output_type: validation
    pass_message: pass
    severity: medium
    tags:
    - stig_alg
    test: 'true'
    when: 'true'
-   cmd: validate
    documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2019-12-20/finding/V-62605
    fail_message: fail
    label: The Palo Alto Networks security platform must only allow incoming communications
        from organization-defined authorized sources forwarded to organization-defined
        authorized destinations.
    name: V-62605
    output_type: validation
    pass_message: pass
    severity: medium
    tags:
    - stig_alg
    test: 'true'
    when: 'true'
-   cmd: validate
    documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2019-12-20/finding/V-62607
    fail_message: fail
    label: The Palo Alto Networks security platform must identify and log internal
        users associated with prohibited outgoing communications traffic.
    name: V-62607
    output_type: validation
    pass_message: pass
    severity: medium
    tags:
    - stig_alg
    test: 'true'
    when: 'true'
-   cmd: validate
    documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2019-12-20/finding/V-62609
    fail_message: fail
    label: The Palo Alto Networks security platform must be configured to integrate
        with a system-wide intrusion detection system.
    name: V-62609
    output_type: validation
    pass_message: pass
    severity: low
    tags:
    - stig_alg
    test: 'true'
    when: 'true'
-   cmd: validate
    documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2019-12-20/finding/V-62611
    fail_message: fail
    label: The Palo Alto Networks security platform must detect use of network services
        that have not been authorized or approved by the ISSM and ISSO, at a minimum.
    name: V-62611
    output_type: validation
    pass_message: pass
    severity: medium
    tags:
    - stig_alg
    test: 'true'
    when: 'true'
-   cmd: validate
    documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2019-12-20/finding/V-62613
    fail_message: fail
    label: The Palo Alto Networks security platform must generate a log record when
        unauthorized network services are detected.
    name: V-62613
    output_type: validation
    pass_message: pass
    severity: medium
    tags:
    - stig_alg
    test: 'true'
    when: 'true'
-   cmd: validate
    documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2019-12-20/finding/V-62615
    fail_message: fail
    label: The Palo Alto Networks security platform must generate an alert to, at
        a minimum, the ISSO and ISSM when unauthorized network services are detected.
    name: V-62615
    output_type: validation
    pass_message: pass
    severity: medium
    tags:
    - stig_alg
    test: 'true'
    when: 'true'
-   cmd: validate
    documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2019-12-20/finding/V-62617
    fail_message: fail
    label: The Palo Alto Networks security platform must continuously monitor inbound
        communications traffic crossing internal security boundaries.
    name: V-62617
    output_type: validation
    pass_message: pass
    severity: medium
    tags:
    - stig_alg
    test: 'true'
    when: 'true'
-   cmd: validate
    documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2019-12-20/finding/V-62619
    fail_message: fail
    label: The Palo Alto Networks security platform must continuously monitor outbound
        communications traffic crossing internal security boundaries.
    name: V-62619
    output_type: validation
    pass_message: pass
    severity: medium
    tags:
    - stig_alg
    test: 'true'
    when: 'true'
-   cmd: validate
    documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2019-12-20/finding/V-62621
    fail_message: fail
    label: The Palo Alto Networks security platform must generate an alert to, at
        a minimum, the ISSO and ISSM when threats identified by authoritative sources
        (e.g., IAVMs or CTOs) are detected.
    name: V-62621
    output_type: validation
    pass_message: pass
    severity: medium
    tags:
    - stig_alg
    test: 'true'
    when: 'true'
-   cmd: validate
    documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2019-12-20/finding/V-62623
    fail_message: fail
    label: The Palo Alto Networks security platform must generate an alert to, at
        a minimum, the ISSO and ISSM when rootkits or other malicious software which
        allows unauthorized privileged access is detected.
    name: V-62623
    output_type: validation
    pass_message: pass
    severity: medium
    tags:
    - stig_alg
    test: 'true'
    when: 'true'
-   cmd: validate
    documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2019-12-20/finding/V-62625
    fail_message: fail
    label: The Palo Alto Networks security platform must generate an alert to, at
        a minimum, the ISSO and ISSM when rootkits or other malicious software which
        allows unauthorized non-privileged access is detected.
    name: V-62625
    output_type: validation
    pass_message: pass
    severity: medium
    tags:
    - stig_alg
    test: 'true'
    when: 'true'
-   cmd: validate
    documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2019-12-20/finding/V-62627
    fail_message: fail
    label: The Palo Alto Networks security platform must generate an alert to, at
        a minimum, the ISSO and ISSM when denial of service incidents are detected.
    name: V-62627
    output_type: validation
    pass_message: pass
    severity: medium
    tags:
    - stig_alg
    test: 'true'
    when: 'true'
-   cmd: validate
    documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2019-12-20/finding/V-62629
    fail_message: fail
    label: The Palo Alto Networks security platform must generate an alert to, at
        a minimum, the ISSO and ISSM when new active propagation of malware infecting
        DoD systems or malicious code adversely affecting the operations and/or security
        of DoD systems is detected.
    name: V-62629
    output_type: validation
    pass_message: pass
    severity: medium
    tags:
    - stig_alg
    test: 'true'
    when: 'true'
-   cmd: validate
    documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2019-12-20/finding/V-62631
    fail_message: fail
    label: The Palo Alto Networks security platform must block traceroutes and ICMP
        probes originating from untrusted networks (e.g., ISP and other non-DoD networks).
    name: V-62631
    output_type: validation
    pass_message: pass
    severity: medium
    tags:
    - stig_alg
    test: 'true'
    when: 'true'
-   cmd: validate
    documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2019-12-20/finding/V-62633
    fail_message: fail
    label: The Palo Alto Networks security platform providing encryption intermediary
        services must implement NIST FIPS-validated cryptography to generate cryptographic
        hashes.
    name: V-62633
    output_type: validation
    pass_message: pass
    severity: medium
    tags:
    - stig_alg
    test: 'true'
    when: 'true'
-   cmd: validate
    documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2019-12-20/finding/V-62635
    fail_message: fail
    label: The Palo Alto Networks security platform, if used for TLS/SSL decryption,
        must use NIST FIPS-validated cryptography to implement encryption.
    name: V-62635
    output_type: validation
    pass_message: pass
    severity: medium
    tags:
    - stig_alg
    test: 'true'
    when: 'true'
-   cmd: validate
    documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2019-12-20/finding/V-62637
    fail_message: fail
    label: The Palo Alto Networks security platform must, at a minimum, off-load threat
        and traffic log records onto a centralized log server in real time.
    name: V-62637
    output_type: validation
    pass_message: pass
    severity: low
    tags:
    - stig_alg
    test: 'true'
    when: 'true'
-   cmd: validate
    documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2019-12-20/finding/V-62639
    fail_message: fail
    label: The Palo Alto Networks security platform must inspect inbound and outbound
        SMTP and Extended SMTP communications traffic (if authorized) for protocol
        compliance and protocol anomalies.
    name: V-62639
    output_type: validation
    pass_message: pass
    severity: medium
    tags:
    - stig_alg
    test: 'true'
    when: 'true'
-   cmd: validate
    documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2019-12-20/finding/V-62641
    fail_message: fail
    label: The Palo Alto Networks security platform must inspect inbound and outbound
        FTP and FTPS communications traffic (if authorized) for protocol compliance
        and protocol anomalies.
    name: V-62641
    output_type: validation
    pass_message: pass
    severity: medium
    tags:
    - stig_alg
    test: 'true'
    when: 'true'
-   cmd: validate
    documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2019-12-20/finding/V-62643
    fail_message: fail
    label: The Palo Alto Networks security platform must inspect inbound and outbound
        HTTP traffic (if authorized) for protocol compliance and protocol anomalies.
    name: V-62643
    output_type: validation
    pass_message: pass
    severity: medium
    tags:
    - stig_alg
    test: 'true'
    when: 'true'
-   cmd: validate
    documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2019-12-20/finding/V-62645
    fail_message: fail
    label: The Palo Alto Networks security platform must send an immediate (within
        seconds) alert to the system administrator, at a minimum, in response to malicious
        code detection.
    name: V-62645
    output_type: validation
    pass_message: pass
    severity: medium
    tags:
    - stig_alg
    test: 'true'
    when: 'true'
