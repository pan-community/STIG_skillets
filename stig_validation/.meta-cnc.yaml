---

name: STIG Validation for PAN-OS
label: skillet generated from STIG documents at stigviewer.com

description: |-
    This skillet accounts for the following stig versions
    alg 2020-09-28
    idps 2020-09-28
    ndm 2019-12-20


type: pan_validation
labels:
    collection:
        - stig
        - Validation

variables:

snippets:
    
    - name: PANW-AG-000015
      label: The Palo Alto Networks security platform, if used to provide intermediary services for remote access communications traffic (TLS or SSL decryption), must ensure inbound and outbound traffic is monitored for compliance with remote access security policies.
      meta:
        stig: alg
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2020-09-28/finding/V-228832

    - name: get_system_info
      cmd: cli
      cmd_str: show system info
      output_type: xml
      outputs:
        - name: operational_mode
          capture_value: /system/operational-mode/text()
    
    - name: PANW-AG-000016
      label: The Palo Alto Networks security platform, if used as a TLS gateway/decryption point or VPN concentrator, must use encryption services that implement NIST FIPS-validated cryptography to protect the confidentiality of remote access sessions.
      meta:
        stig: alg
        severity: medium
      test: operational_mode == 'fips-cc'
      fail_message: The NGFW must be running in FIPS mode
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2020-09-28/finding/V-228833
    
    - name: PANW-AG-000017
      label: The Palo Alto Networks security platform that stores secret or private keys must use FIPS-approved key management technology and processes in the production and control of private/secret cryptographic keys.
      meta:
        stig: alg
        severity: medium
      test: operational_mode == 'fips-cc'
      fail_message: The NGFW must be running in FIPS mode
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2020-09-28/finding/V-228834
    
    - name: PANW-AG-000020
      label: The Palo Alto Networks security platform, if used as a TLS gateway/decryption point or VPN concentrator, must use NIST FIPS-validated cryptography to protect the integrity of remote access sessions.
      meta:
        stig: alg
        severity: medium
      test: operational_mode == 'fips-cc'
      fail_message: The NGFW must be running in FIPS mode
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2020-09-28/finding/V-228835

    - name: deny_no_log_policies
      cmd: parse
      variable: config
      outputs:
        - name: deny_no_log_pols
          capture_list: |-
            /config/devices/entry[@name='localhost.localdomain']/vsys/entry/rulebase/security/rules/entry
            [action="deny" and log-end="no" and not(log-start="yes") and not(disabled="yes")]
        - name: deny_no_log_policies_names
          capture_expression: deny_no_log_pols | map(attribute="entry.@name") | list
    
    - name: PANW-AG-000024
      label: The Palo Alto Networks security platform must log violations of security policies.
      meta:
        stig: alg
        severity: low
      test: not deny_no_log_policies_names
      fail_message: Deny policies without logging - {% for pol in deny_no_log_policies_names %}{{ pol }} {% endfor %}
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2020-09-28/finding/V-228836
    
    - name: PANW-AG-000035
      label: The Palo Alto Networks security platform must only enable User-ID on trusted zones.
      meta:
        stig: alg
        severity: medium
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2020-09-28/finding/V-228837
      include: CIS_NGFW_benchmark_v90
      include_snippets:
        - name: capture_userid_enabled_zones
        - name: userid_internal_zones_only
    
    - name: PANW-AG-000036
      label: The Palo Alto Networks security platform must disable WMI probing if it is not used.
      meta:
        stig: alg
        severity: medium
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2020-09-28/finding/V-228838
      include: CIS_NGFW_benchmark_v90
      include_snippets:
        - name: captured_wmi_probing_disabled
        - name: wmi_probing_disabled

    - name: capture_dns_proxy
      cmd: parse
      variable: config
      outputs:
        - name: capture_dns_proxy
          capture_list: /config/devices/entry[@name='localhost.localdomain']/network/dns-proxy/entry
        - name: capture_dns_proxy_names
          capture_expression: capture_dns_proxy | map(attribute="entry.@name") | list
    
    - name: PANW-AG-000037
      label: The Palo Alto Networks security platform must not enable the DNS proxy.
      meta:
        stig: alg
        severity: medium
      test: not capture_dns_proxy_names 
      fail_message: DNS proxy must not be configured
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2020-09-28/finding/V-228839
    
    - name: PANW-AG-000038
      label: The Palo Alto Networks security platform must be configured to prohibit or restrict the use of functions, ports, protocols, and/or services, as defined in the PPSM CAL and vulnerability assessments.
      meta:
        stig: alg
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2020-09-28/finding/V-228840

    - name: get_decryption_policies
      cmd: parse
      variable: config
      outputs:
        - name: decryption_policies
          capture_list: |-
            /config/devices/entry[@name='localhost.localdomain']/vsys/entry/rulebase/decryption/rules/entry
        - name: ocsp_responders
          capture_list:  /config/shared/ocsp-responder/entry
    
    - name: PANW-AG-000044
      label: The Palo Alto Networks security platform that provides intermediary services for TLS must validate certificates used for TLS functions by performing RFC 5280-compliant certification path validation.
      meta:
        stig: alg
        severity: medium
      test: not decryption_policies or ocsp_responders
      fail_message: OCSP responders must be configured if decryption is used
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2020-09-28/finding/V-228841
    
    - name: PANW-AG-000047
      label: The Palo Alto Networks security platform must protect against the use of internal systems from launching Denial of Service (DoS) attacks against other networks or endpoints.
      meta:
        stig: alg
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2020-09-28/finding/V-228842
    
    - name: PANW-AG-000049
      label: The Palo Alto Networks security platform must block phone home traffic.
      meta:
        stig: alg
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2020-09-28/finding/V-228843
    
    - name: capture_zone_protect_profile_crafted_pkts
      cmd: parse
      variable: config
      outputs:
        - name: zone_protect_profile_pkt_attack_enabled
          capture_list: |-
            /config/devices/entry[@name='localhost.localdomain']/network/profiles/zone-protection-profile/entry
            [discard-ip-spoof='yes']/@name
        - name: zones_with_pkt_attack_enabled_object
          capture_object: |-
            /config/devices/entry[@name='localhost.localdomain']/vsys/entry[@name='vsys1']/zone/entry
          filter_items: |-
            item | element_value('network.zone-protection-profile') not in zone_protect_profile_pkt_attack_enabled
        - name: zones_permitting_spoofing
          capture_expression: zones_with_pkt_attack_enabled_object | map(attribute="entry.@name") | list

    - name: PANW-AG-000050
      label: The Palo Alto Networks security platform must deny outbound IP packets that contain an illegitimate address in the source address field.
      meta:
        stig: alg
        severity: medium
      test: not zones_permitting_spoofing
      fail_message: Zones that permit IP Spoofing - {% for zone in zones_permitting_spoofing %}{{ zone }} {% endfor %}
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2020-09-28/finding/V-228844
    
    - name: capture_default_permit_policy
      cmd: parse
      variable: config
      outputs:
        - name: default_any_any_policies
          capture_list: |-
            /config/devices/entry[@name='localhost.localdomain']/vsys/entry/rulebase/security/rules/entry
            [application/member="any" and source/member="any" and destination/member="any" and action="allow" and not (disabled="yes")]/@name

    - name: PANW-AG-000051
      label: The Palo Alto Networks security platform must deny network communications traffic by default and allow network communications traffic by exception (i.e., deny all, permit by exception).
      meta:
        stig: alg
        severity: medium
      test: not default_any_any_policies
      fail_message: Policies that permit by default - {% for pol in default_any_any_policies %}{{ pol }}{% endfor %}
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2020-09-28/finding/V-228845

    - name: capture_device_session_timeout_tcp
      cmd: parse
      variable: config
      outputs:
        - name: device_session_timeout_tcp
          capture_value: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting/session/timeout-tcp
        - name: device_session_timeout_udp
          capture_value: /config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting/session/timeout-udp
        - name: override_app_timeout
          capture_list: /config/shared/override/application/entry[tcp-timeout > 900 or udp-timeout > 900]/@name
        - name: custom_app_timeout
          capture_list: /config/devices/entry[@name='localhost.localdomain']/vsys/entry[@name='vsys1']/application/entry[tcp-timeout > 900 or udp-timeout > 900]/@name
    
    - name: PANW-AG-000052
      label: The Palo Alto Networks security platform must terminate communications sessions after 15 minutes of inactivity.
      meta:
        stig: alg
        severity: medium
      # TCP default is higher than 900 so there must be a configuration element to be valid
      test: (
         device_session_timeout_tcp | int < 901
         and ( not device_session_timeout_udp or device_session_timeout_udp | int < 901 )
         and not override_app_timeout
         and not custom_app_timeout
         )
      fail_message: |
        {% if device_session_timeout_tcp | int > 900 or device_session_timeout_udp | int > 900 %}Default session timeout for TCP or UDP too high. {% endif %}
        {% if override_app_timeout or custom_app_timeout %}Applications with timeout above 900: {% for app in custom_app_timeout %}{{ app }} {% endfor %} {% for app in override_app_timeout %}{{ app }} {% endfor %}{% endif %}
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2020-09-28/finding/V-228846
    
    - name: PANW-AG-000060
      label: The Palo Alto Networks security platform must update malicious code protection mechanisms and signature definitions whenever new releases are available in accordance with organizational configuration management policy and procedures.
      meta:
        stig: alg
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2020-09-28/finding/V-228847

    - name: capture_av_profile_in_policies
      cmd: parse
      variable: config
      outputs:
        - name: valid_av_profiles
          capture_list: |-
            /config/devices/entry[@name='localhost.localdomain']/vsys/entry[@name='vsys1']/profiles/virus/entry
            [
              (decoder/entry[@name='smtp']/action='drop' or decoder/entry[@name='smtp']/action='reset-both')
              and (decoder/entry[@name='smtp']/wildfire-action='drop' or decoder/entry[@name='smtp']/wildfire-action='reset-both')
              and (decoder/entry[@name='pop3']/action='drop' or decoder/entry[@name='pop3']/action='reset-both')
              and (decoder/entry[@name='pop3']/wildfire-action='drop' or decoder/entry[@name='pop3']/wildfire-action='reset-both')
              and (decoder/entry[@name='imap']/action='drop' or decoder/entry[@name='imap']/action='reset-both')
              and (decoder/entry[@name='imap']/wildfire-action='drop' or decoder/entry[@name='imap']/wildfire-action='reset-both')
            ]/@name
        - name: invalid_av_profiles
          capture_list: /config/devices/entry[@name='localhost.localdomain']/vsys/entry[@name='vsys1']/profiles/virus/entry/@name
          filter_items: item not in valid_av_profiles
        - name: valid_av_profile_groups
          capture_list: |-
            /config/devices/entry[@name='localhost.localdomain']/vsys/entry[@name='vsys1']/profile-group/
            entry[count(virus) > 0 and not(virus/member='default')]/@name
        - name: invalid_av_profile_groups
          capture_list: /config/devices/entry[@name='localhost.localdomain']/vsys/entry[@name='vsys1']/profile-group/entry/@name
          filter_items: item not in valid_av_profile_groups
        # At this point we can assume all profiles and profile-groups have vaild antivirus settings
        - name: invalid_security_policies_av
          capture_list: |-
            /config/devices/entry[@name='localhost.localdomain']/vsys/entry[@name='vsys1']/rulebase/security/rules/entry
            [
              action='allow'
              and (
                count(profile-setting/group/member) = 0
                and (
                  count(profile-setting/profiles/virus/member) = 0
                  or profile-setting/profiles/virus/member='default'
                )
              ) 
            ]/@name

    - name: PANW-AG-000062
      label: The Palo Alto Networks security platform must drop malicious code upon detection.
      meta:
        stig: alg
        severity: medium
      test: not( invalid_av_profiles or invalid_av_profile_groups or invalid_security_policies_av )
      fail_message: |
        {% if invalid_av_profiles %}Invalid AV profiles - {% for prof in invalid_av_profiles %}{{ prof }} {% endfor %}{% endif %}
        {% if invalid_av_profile_groups %}Invalid profile groups - {% for prof in invalid_av_profile_groups %}{{ prof }} {% endfor %}{% endif %}
        {% if invalid_security_policies_av %}Security policies with invalid AV - {% for pol in invalid_security_policies_av %}{{ pol }} {% endfor %}{% endif %}
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2020-09-28/finding/V-228848
    
    - name: PANW-AG-000063
      label: The Palo Alto Networks security platform must delete or quarantine malicious code in response to malicious code detection.
      meta:
        stig: alg
        severity: medium
      test: not( invalid_av_profiles or invalid_av_profile_groups or invalid_security_policies_av )
      fail_message: |
        {% if invalid_av_profiles %}Invalid AV profiles - {% for prof in invalid_av_profiles %}{{ prof }} {% endfor %}{% endif %}
        {% if invalid_av_profile_groups %}Invalid profile groups - {% for prof in invalid_av_profile_groups %}{{ prof }} {% endfor %}{% endif %}
        {% if invalid_security_policies_av %}Security policies with invalid AV - {% for pol in invalid_security_policies_av %}{{ pol }} {% endfor %}{% endif %}
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2020-09-28/finding/V-228849
    
    - name: capture_virus_alerting
      cmd: parse
      variable: config
      outputs:
        - name: device_server_profile_email
          capture_list: /config/shared/log-settings/email/entry/@name
        - name: log_profiles_with_email 
          capture_list: | 
            /config/devices/entry[@name='localhost.localdomain']/vsys/entry[@name='vsys1']/log-settings/profiles/entry
            [count(match-list/entry/send-email/member) > 0]/@name
        - name: security_policies_with_virus_no_email
          capture_list: |
            /config/devices/entry[@name='localhost.localdomain']/vsys/entry[@name='vsys1']/rulebase/security/rules/entry
            [
              action='allow'
              and not(disabled="yes")
              and (
                count(profile-seting/profile/virus/member) > 0
                or count(profile-setting/group/member) > 0
              )
            ]
          filter_items: item | element_value('log-setting') not in log_profiles_with_email 
        - name: security_policies_with_virus_no_email_names
          capture_expression: security_policies_with_virus_no_email | map(attribute="entry.@name") | list 

    - name: PANW-AG-000064
      label: The Palo Alto Networks security platform must send an immediate (within seconds) alert to the system administrator, at a minimum, in response to malicious code detection.
      meta:
        stig: alg
        severity: medium
      test: not security_policies_with_virus_no_email_names
      fail_message: AV policies that do not have email logging - {% for pol in security_policies_with_virus_no_email_names %}{{ pol }} {% endfor %}
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2020-09-28/finding/V-228850

    
    - name: PANW-AG-000065
      label: The Palo Alto Networks security platform must automatically update malicious code protection mechanisms.
      meta:
        stig: alg
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2020-09-28/finding/V-228851
    
    - name: PANW-AG-000073
      label: The Palo Alto Networks security platform must deny or restrict detected prohibited mobile code.
      meta:
        stig: alg
        severity: medium
      test: not( invalid_av_profiles or invalid_av_profile_groups or invalid_security_policies_av )
      fail_message: |
        {% if invalid_av_profiles %}Invalid AV profiles - {% for prof in invalid_av_profiles %}{{ prof }} {% endfor %}{% endif %}
        {% if invalid_av_profile_groups %}Invalid profile groups - {% for prof in invalid_av_profile_groups %}{{ prof }} {% endfor %}{% endif %}
        {% if invalid_security_policies_av %}Security policies with invalid AV - {% for pol in invalid_security_policies_av %}{{ pol }} {% endfor %}{% endif %}
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2020-09-28/finding/V-228852
    
    - name: PANW-AG-000074
      label: The Palo Alto Networks security platform must prevent the download of prohibited mobile code.
      meta:
        stig: alg
        severity: medium
      test: not( invalid_av_profiles or invalid_av_profile_groups or invalid_security_policies_av )
      fail_message: |
        {% if invalid_av_profiles %}Invalid AV profiles - {% for prof in invalid_av_profiles %}{{ prof }} {% endfor %}{% endif %}
        {% if invalid_av_profile_groups %}Invalid profile groups - {% for prof in invalid_av_profile_groups %}{{ prof }} {% endfor %}{% endif %}
        {% if invalid_security_policies_av %}Security policies with invalid AV - {% for pol in invalid_security_policies_av %}{{ pol }} {% endfor %}{% endif %}
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2020-09-28/finding/V-228853
    
    - name: PANW-AG-000078
      label: The Palo Alto Networks security platform, if used as a TLS gateway/decryption point or VPN concentrator, must control remote access methods (inspect and filter traffic).
      meta:
        stig: alg
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2020-09-28/finding/V-228854
    
    - name: PANW-AG-000079
      label: The Palo Alto Networks security, if used as a TLS gateway/decryption point or VPN concentrator, must provide the capability to immediately disconnect or disable remote access to the information system.
      meta:
        stig: alg
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2020-09-28/finding/V-228855
    
    - name: PANW-AG-000080
      label: To protect against data mining, the Palo Alto Networks security platform must detect and prevent SQL and other code injection attacks launched against data storage objects, including, at a minimum, databases, database records, queries, and fields.
      meta:
        stig: alg
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2020-09-28/finding/V-228856
    
    - name: PANW-AG-000081
      label: To protect against data mining, the Palo Alto Networks security platform must detect and prevent code injection attacks launched against application objects including, at a minimum, application URLs and application code.
      meta:
        stig: alg
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2020-09-28/finding/V-228857

    - name: capture_logging_settings
      cmd: parse
      variable: config
      outputs:
        - name: valid_syslog_profiles
          capture_list: /config/shared/log-settings/syslog/entry[count(server)>0]/@name
        - name: valid_syslog_log_forwarding_profile
          capture_list: /config/shared/log-settings/config/match-list/entry[count(send-syslog/member)>0]/@name
        - name: valid_system_syslog_settings
          capture_list: /config/shared/log-settings/system/match-list/entry[count(send-syslog/member)>0]/@name
    
    - name: PANW-AG-000094
      label: The Palo Alto Networks security platform must off-load audit records onto a different system or media than the system being audited.
      meta:
        stig: alg
        severity: medium
      test: valid_syslog_profiles and valid_syslog_log_forwarding_profile and valid_system_syslog_settings
      fail_message: |
        {% if not valid_syslog_profiles %}No valid syslog profiles. {% endif %}
        {% if not valid_syslog_log_forwarding_profile %}No valid syslog log forwarding profiles. {% endif %}
        {% if not valid_system_syslog_settings %}No valid system syslog forwarders.{% endif %}
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2020-09-28/finding/V-228858
    
    - name: PANW-AG-000101
      label: The Palo Alto Networks security platform being used for TLS/SSL decryption using PKI-based user authentication must only accept end entity certificates issued by DoD PKI or DoD-approved PKI Certificate Authorities (CAs) for the establishment of protected sessions.
      meta:
        stig: alg
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2020-09-28/finding/V-228859
    
    - name: PANW-AG-000102
      label: The Palo Alto Networks security platform must protect against Denial of Service (DoS) attacks by employing rate-based attack prevention behavior analysis (traffic thresholds).
      meta:
        stig: alg
        severity: high
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2020-09-28/finding/V-228860

    - name: capture_vulnerability_profile_rules
      cmd: parse
      variable: config
      outputs:
        - name: valid_vulnerability_profiles
          capture_list: |-
            /config/devices/entry[@name='localhost.localdomain']/vsys/entry[@name='vsys1']/profiles/vulnerability/entry/rules/entry
            [count(action/reset-both)>0]/../../@name
        - name: valid_vulnerability_profile_groups
          capture_list: |-
            /config/devices/entry[@name='localhost.localdomain']/vsys/entry[@name='vsys1']/profile-group/
            entry[count(vulnerability)>0 and not(vulnerability/member='default')]/@name
        - name: invalid_vulnerability_interzone_security_policies
          capture_list: |-
            /config/devices/entry[@name='localhost.localdomain']/vsys/entry/rulebase/security/rules/entry
            [
              action="allow" and not(disabled="yes")
              and (
                not(to/member/text()=from/member/text())
                or to/member='any' or from/member='any'
                or count(to/member) > 1
                or count(from/member) > 1
                )
            ]
          filter_items: |-
            item | element_value('profile-setting.profiles.vulnerability.member') not in valid_vulnerability_profiles
            and item | element_value('profile-setting.group.member') not in valid_vulnerability_profile_groups
        - name: invalid_vulnerability_interzone_security_policies_names
          capture_expression: invalid_vulnerability_interzone_security_policies | map(attribute="entry.@name") | list
    
    - name: PANW-AG-000105
      label: The Palo Alto Networks security platform must use a Vulnerability Protection Profile that blocks any critical, high, or medium threats.
      meta:
        stig: alg
        severity: medium
      test: not invalid_vulnerability_interzone_security_policies_names
      fail_message: Policies with bad vulnerability profiles - {% for pol in invalid_vulnerability_interzone_security_policies_names %}{{ pol }} {% endfor %}
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2020-09-28/finding/V-228861
    
    - name: PANW-AG-000107
      label: The Palo Alto Networks security platform must only allow incoming communications from organization-defined authorized sources forwarded to organization-defined authorized destinations.
      meta:
        stig: alg
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2020-09-28/finding/V-228862
    
    - name: PANW-AG-000109
      label: The Palo Alto Networks security platform must identify and log internal users associated with prohibited outgoing communications traffic.
      meta:
        stig: alg
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2020-09-28/finding/V-228863
    
    - name: PANW-AG-000111
      label: The Palo Alto Networks security platform must be configured to integrate with a system-wide intrusion detection system.
      meta:
        stig: alg
        severity: low
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2020-09-28/finding/V-228864
    
    - name: PANW-AG-000112
      label: The Palo Alto Networks security platform must detect use of network services that have not been authorized or approved by the ISSM and ISSO, at a minimum.
      meta:
        stig: alg
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2020-09-28/finding/V-228865
    
    - name: PANW-AG-000113
      label: The Palo Alto Networks security platform must generate a log record when unauthorized network services are detected.
      meta:
        stig: alg
        severity: medium
      test: not deny_no_log_policies_names
      fail_message: Deny policies without logging - {% for pol in deny_no_log_policies_names %}{{ pol }} {% endfor %}
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2020-09-28/finding/V-228866

    - name: deny_no_log_setting
      cmd: parse
      variable: config
      outputs:
        - name: deny_no_log_pols
          capture_list: |-
            /config/devices/entry[@name='localhost.localdomain']/vsys/entry/rulebase/security/rules/entry
            [action="deny" and not(log-setting) and not(disabled="yes")]/@name
    
    - name: PANW-AG-000114
      label: The Palo Alto Networks security platform must generate an alert to, at a minimum, the ISSO and ISSM when unauthorized network services are detected.
      meta:
        stig: alg
        severity: medium
      test: not deny_no_log_pols
      fail_message: Deny policies without forwarding profiles - {%for pol in deny_no_log_pols %}{{ pol }} {% endfor %}
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2020-09-28/finding/V-228867
    
    - name: PANW-AG-000115
      label: The Palo Alto Networks security platform must continuously monitor inbound communications traffic crossing internal security boundaries.
      meta:
        stig: alg
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2020-09-28/finding/V-228868
    
    - name: PANW-AG-000116
      label: The Palo Alto Networks security platform must continuously monitor outbound communications traffic crossing internal security boundaries.
      meta:
        stig: alg
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2020-09-28/finding/V-228869
    
    - name: PANW-AG-000118
      label: The Palo Alto Networks security platform must generate an alert to, at a minimum, the ISSO and ISSM when threats identified by authoritative sources (e.g., IAVMs or CTOs) are detected.
      meta:
        stig: alg
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2020-09-28/finding/V-228870
    
    - name: PANW-AG-000119
      label: The Palo Alto Networks security platform must generate an alert to, at a minimum, the ISSO and ISSM when rootkits or other malicious software which allows unauthorized privileged access is detected.
      meta:
        stig: alg
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2020-09-28/finding/V-228871
    
    - name: PANW-AG-000120
      label: The Palo Alto Networks security platform must generate an alert to, at a minimum, the ISSO and ISSM when rootkits or other malicious software which allows unauthorized non-privileged access is detected.
      meta:
        stig: alg
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2020-09-28/finding/V-228872
    
    - name: PANW-AG-000121
      label: The Palo Alto Networks security platform must generate an alert to, at a minimum, the ISSO and ISSM when denial of service incidents are detected.
      meta:
        stig: alg
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2020-09-28/finding/V-228873
    
    - name: PANW-AG-000122
      label: The Palo Alto Networks security platform must generate an alert to, at a minimum, the ISSO and ISSM when new active propagation of malware infecting DoD systems or malicious code adversely affecting the operations and/or security of DoD systems is detected.
      meta:
        stig: alg
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2020-09-28/finding/V-228874
    
    - name: PANW-AG-000127
      label: The Palo Alto Networks security platform must block traceroutes and ICMP probes originating from untrusted networks (e.g., ISP and other non-DoD networks).
      meta:
        stig: alg
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2020-09-28/finding/V-228875
    
    - name: PANW-AG-000141
      label: The Palo Alto Networks security platform providing encryption intermediary services must implement NIST FIPS-validated cryptography to generate cryptographic hashes.
      meta:
        stig: alg
        severity: medium
      test: operational_mode == 'fips-cc'
      fail_message: The NGFW must be running in FIPS mode
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2020-09-28/finding/V-228876
    
    - name: PANW-AG-000143
      label: The Palo Alto Networks security platform, if used for TLS/SSL decryption, must use NIST FIPS-validated cryptography to implement encryption.
      meta:
        stig: alg
        severity: medium
      test: operational_mode == 'fips-cc'
      fail_message: The NGFW must be running in FIPS mode
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2020-09-28/finding/V-228877
    
    - name: PANW-AG-000144
      label: The Palo Alto Networks security platform must, at a minimum, off-load threat and traffic log records onto a centralized log server in real time.
      meta:
        stig: alg
        severity: low
      test: valid_syslog_profiles and valid_syslog_log_forwarding_profile and valid_system_syslog_settings
      fail_message: |
        {% if not valid_syslog_profiles %}No valid syslog profiles. {% endif %}
        {% if not valid_syslog_log_forwarding_profile %}No valid syslog log forwarding profiles. {% endif %}
        {% if not valid_system_syslog_settings %}No valid system syslog forwarders.{% endif %}
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2020-09-28/finding/V-228878

    - name: capture_smtp_policies_no_av
      cmd: parse
      variable: config
      outputs:
        - name: smtp_policies_no_av
          capture_list: |
            /config/devices/entry[@name='localhost.localdomain']/vsys/entry/rulebase/security/rules/entry
            [
              action="allow"
              and not(disabled="yes")
              and (
                application/member/text()='smtp'
                or application/member/text()='smtp-base'
                or application/member/text()='smtp-starttls'
              )
            ]
          filter_items: |
            item | element_value('profile-setting.profiles.virus.member') not in valid_av_profiles
            and item | element_value('profile-setting.group.member') not in valid_av_profile_groups 
        - name: smtp_policies_no_av_names
          capture_expression: smtp_policies_no_av | map(attribute="entry.@name") | list
    
    - name: PANW-AG-000147
      label: The Palo Alto Networks security platform must inspect inbound and outbound SMTP and Extended SMTP communications traffic (if authorized) for protocol compliance and protocol anomalies.
      meta:
        stig: alg
        severity: medium
      test: not smtp_policies_no_av
      fail_message: SMTP policies without av - {% for pol in smtp_policies_no_av %}{{ pol }} {% endfor %}
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2020-09-28/finding/V-228879
    
    - name: PANW-AG-000148
      label: The Palo Alto Networks security platform must inspect inbound and outbound FTP and FTPS communications traffic (if authorized) for protocol compliance and protocol anomalies.
      meta:
        stig: alg
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2020-09-28/finding/V-228880
    
    - name: PANW-AG-000149
      label: The Palo Alto Networks security platform must inspect inbound and outbound HTTP traffic (if authorized) for protocol compliance and protocol anomalies.
      meta:
        stig: alg
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_alg/2020-09-28/finding/V-228881
    
    - name: PANW-IP-000001
      label: The Palo Alto Networks security platform must enable Antivirus, Anti-spyware, and Vulnerability Protection for all authorized traffic.
      meta:
        stig: idps
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_idps/2020-09-28/finding/V-207688
    
    - name: PANW-IP-000007
      label: The Palo Alto Networks security platform must produce audit records containing information to establish the source of the event, including, at a minimum, originating source address.
      meta:
        stig: idps
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_idps/2020-09-28/finding/V-207689
    
    - name: PANW-IP-000008
      label: The Palo Alto Networks security platform must capture traffic of detected/dropped malicious code.
      meta:
        stig: idps
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_idps/2020-09-28/finding/V-207690
    
    - name: PANW-IP-000010
      label: In the event of a logging failure caused by the lack of audit record storage capacity, the Palo Alto Networks security platform must continue generating and storing audit records if possible, overwriting the oldest audit records in a first-in-first-out manner.
      meta:
        stig: idps
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_idps/2020-09-28/finding/V-207691
    
    - name: PANW-IP-000018
      label: The Palo Alto Networks security platform must have a DoS Protection Profile for outbound traffic applied to a policy for traffic originating from the internal zone going to the external zone.
      meta:
        stig: idps
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_idps/2020-09-28/finding/V-207692
    
    - name: PANW-IP-000020
      label: The Palo Alto Networks security platform must detect and deny any prohibited mobile or otherwise malicious code at the enclave boundary.
      meta:
        stig: idps
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_idps/2020-09-28/finding/V-207693
    
    - name: PANW-IP-000024
      label: The Palo Alto Networks security platform must install updates for application software files, signature definitions, detection heuristics, and vendor-provided rules when new releases are available in accordance with organizational configuration management policy and procedures.
      meta:
        stig: idps
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_idps/2020-09-28/finding/V-207694
    
    - name: PANW-IP-000026
      label: The Palo Alto Networks security platform must detect and drop any prohibited mobile or otherwise malicious code at internal boundaries.
      meta:
        stig: idps
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_idps/2020-09-28/finding/V-207695
    
    - name: PANW-IP-000028
      label: The Palo Alto Networks security platform must send an immediate (within seconds) alert to, at a minimum, the SA when malicious code is detected.
      meta:
        stig: idps
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_idps/2020-09-28/finding/V-207696
    
    - name: PANW-IP-000029
      label: The Palo Alto Networks security platform must automatically install updates to signature definitions, detection heuristics, and vendor-provided rules.
      meta:
        stig: idps
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_idps/2020-09-28/finding/V-207697
    
    - name: PANW-IP-000030
      label: The Palo Alto Networks security platform must block outbound ICMP Destination Unreachable, Redirect, and Address Mask reply messages.
      meta:
        stig: idps
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_idps/2020-09-28/finding/V-207698
    
    - name: PANW-IP-000031
      label: The Palo Alto Networks security platform must block malicious ICMP packets.
      meta:
        stig: idps
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_idps/2020-09-28/finding/V-207699
    
    - name: PANW-IP-000032
      label: To protect against unauthorized data mining, the Palo Alto Networks security platform must detect and prevent SQL and other code injection attacks launched against data storage objects, including, at a minimum, databases, database records, queries, and fields.
      meta:
        stig: idps
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_idps/2020-09-28/finding/V-207700
    
    - name: PANW-IP-000033
      label: To protect against unauthorized data mining, the Palo Alto Networks security platform must detect and prevent code injection attacks launched against application objects including, at a minimum, application URLs and application code.
      meta:
        stig: idps
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_idps/2020-09-28/finding/V-207701
    
    - name: PANW-IP-000039
      label: The Palo Alto Networks security platform must off-load log records to a centralized log server.
      meta:
        stig: idps
        severity: low
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_idps/2020-09-28/finding/V-207702
    
    - name: PANW-IP-000041
      label: The Palo Alto Networks security platform must protect against or limit the effects of known and unknown types of Denial of Service (DoS) attacks by employing rate-based attack prevention behavior analysis (traffic thresholds).
      meta:
        stig: idps
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_idps/2020-09-28/finding/V-207703
    
    - name: PANW-IP-000043
      label: The Palo Alto Networks security platform must use a Vulnerability Protection Profile that blocks any critical, high, or medium threats.
      meta:
        stig: idps
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_idps/2020-09-28/finding/V-207704
    
    - name: PANW-IP-000045
      label: Palo Alto Networks security platform components, including sensors, event databases, and management consoles must integrate with a network-wide monitoring capability.
      meta:
        stig: idps
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_idps/2020-09-28/finding/V-207705
    
    - name: PANW-IP-000046
      label: The Palo Alto Networks security platform must detect use of network services that have not been authorized or approved by the ISSM and ISSO, at a minimum.
      meta:
        stig: idps
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_idps/2020-09-28/finding/V-207706
    
    - name: PANW-IP-000047
      label: The Palo Alto Networks security platform must generate a log record when unauthorized network services are detected.
      meta:
        stig: idps
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_idps/2020-09-28/finding/V-207707
    
    - name: PANW-IP-000048
      label: The Palo Alto Networks security platform must generate an alert to the ISSO and ISSM, at a minimum, when unauthorized network services are detected.
      meta:
        stig: idps
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_idps/2020-09-28/finding/V-207708
    
    - name: PANW-IP-000049
      label: The Palo Alto Networks security platform must continuously monitor inbound communications traffic for unusual/unauthorized activities or conditions.
      meta:
        stig: idps
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_idps/2020-09-28/finding/V-207709
    
    - name: PANW-IP-000050
      label: The Palo Alto Networks security platform must continuously monitor outbound communications traffic for unusual/unauthorized activities or conditions.
      meta:
        stig: idps
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_idps/2020-09-28/finding/V-207710
    
    - name: PANW-IP-000051
      label: The Palo Alto Networks security platform must send an alert to, at a minimum, the ISSO and ISSM when intrusion detection events are detected which indicate a compromise or potential for compromise.
      meta:
        stig: idps
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_idps/2020-09-28/finding/V-207711
    
    - name: PANW-IP-000052
      label: The Palo Alto Networks security platform must send an alert to, at a minimum, the ISSO and ISSM when threats identified by authoritative sources (e.g., IAVMs or CTOs) are detected.
      meta:
        stig: idps
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_idps/2020-09-28/finding/V-207712
    
    - name: PANW-IP-000053
      label: The Palo Alto Networks security platform must generate an alert to, at a minimum, the ISSO and ISSM when rootkits or other malicious software which allows unauthorized privileged or non-privileged access is detected.
      meta:
        stig: idps
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_idps/2020-09-28/finding/V-207713
    
    - name: PANW-IP-000055
      label: The Palo Alto Networks security platform must send an alert to, at a minimum, the ISSO and ISSM when denial of service incidents are detected.
      meta:
        stig: idps
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_idps/2020-09-28/finding/V-207714
    
    - name: PANW-IP-000056
      label: The Palo Alto Networks security platform must generate an alert to, at a minimum, the ISSO and ISSM when new active propagation of malware infecting DoD systems or malicious code adversely affecting the operations and/or security of DoD systems is detected.
      meta:
        stig: idps
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_idps/2020-09-28/finding/V-207715
    
    - name: PANW-IP-000058
      label: The Palo Alto Networks security platform must off-load log records to a centralized log server in real-time.
      meta:
        stig: idps
        severity: low
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_idps/2020-09-28/finding/V-207716
    
    - name: PANW-NM-000015
      label: The Palo Alto Networks security platform must enforce the limit of three consecutive invalid logon attempts.
      meta:
        stig: ndm
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_ndm/2019-12-20/finding/V-62705
    
    - name: PANW-NM-000016
      label: The Palo Alto Networks security platform must display the Standard Mandatory DoD Notice and Consent Banner before granting access to the device.
      meta:
        stig: ndm
        severity: low
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_ndm/2019-12-20/finding/V-62707
    
    - name: PANW-NM-000023
      label: The Palo Alto Networks security platform must allow only the ISSM (or individuals or roles appointed by the ISSM) in the Audit Administrator (auditadmin) role, or in a custom role with full access to audit logs, or any account that has full access to audit logs.
      meta:
        stig: ndm
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_ndm/2019-12-20/finding/V-62709
    
    - name: PANW-NM-000024
      label: The Palo Alto Networks security platform must generate audit records when successful/unsuccessful attempts to access privileges occur.
      meta:
        stig: ndm
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_ndm/2019-12-20/finding/V-62711
    
    - name: PANW-NM-000029
      label: The Palo Alto Networks security platform must produce audit log records containing information (FQDN, unique hostname, management IP address) to establish the source of events.
      meta:
        stig: ndm
        severity: low
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_ndm/2019-12-20/finding/V-62713
    
    - name: PANW-NM-000042
      label: The Palo Alto Networks security platform must back up audit records at least every seven days onto a different system or system component than the system or component being audited.
      meta:
        stig: ndm
        severity: low
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_ndm/2019-12-20/finding/V-62715
    
    - name: PANW-NM-000046
      label: The Palo Alto Networks security platform must be configured to prohibit the use of all unnecessary and/or nonsecure functions, ports, protocols, and/or services, as defined in the PPSM CAL and vulnerability assessments.
      meta:
        stig: ndm
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_ndm/2019-12-20/finding/V-62717
    
    - name: PANW-NM-000047
      label: The Palo Alto Networks security platform must uniquely identify and authenticate organizational administrators (or processes acting on behalf of organizational administrators).
      meta:
        stig: ndm
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_ndm/2019-12-20/finding/V-62719
    
    - name: PANW-NM-000051
      label: The Palo Alto Networks security platform must implement replay-resistant authentication mechanisms for network access to privileged accounts.
      meta:
        stig: ndm
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_ndm/2019-12-20/finding/V-62721
    
    - name: PANW-NM-000053
      label: If multifactor authentication is not available and passwords must be used, the Palo Alto Networks security platform must enforce a minimum 15-character password length.
      meta:
        stig: ndm
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_ndm/2019-12-20/finding/V-62723
    
    - name: PANW-NM-000054
      label: If multifactor authentication is not available and passwords must be used, the Palo Alto Networks security platform must prohibit password reuse for a minimum of five generations.
      meta:
        stig: ndm
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_ndm/2019-12-20/finding/V-62725
    
    - name: PANW-NM-000055
      label: If multifactor authentication is not available and passwords must be used, the Palo Alto Networks security platform must enforce password complexity by requiring that at least one upper-case character be used.
      meta:
        stig: ndm
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_ndm/2019-12-20/finding/V-62727
    
    - name: PANW-NM-000056
      label: If multifactor authentication is not available and passwords must be used, the Palo Alto Networks security platform must enforce password complexity by requiring that at least one lower-case character be used.
      meta:
        stig: ndm
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_ndm/2019-12-20/finding/V-62729
    
    - name: PANW-NM-000057
      label: If multifactor authentication is not available and passwords must be used, the Palo Alto Networks security platform must enforce password complexity by requiring that at least one numeric character be used.
      meta:
        stig: ndm
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_ndm/2019-12-20/finding/V-62731
    
    - name: PANW-NM-000058
      label: If multifactor authentication is not available and passwords must be used, the Palo Alto Networks security platform must enforce password complexity by requiring that at least one special character be used.
      meta:
        stig: ndm
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_ndm/2019-12-20/finding/V-62733
    
    - name: PANW-NM-000059
      label: If multifactor authentication is not available and passwords must be used, the Palo Alto Networks security platform must require that when a password is changed, the characters are changed in at least 8 of the positions within the password.
      meta:
        stig: ndm
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_ndm/2019-12-20/finding/V-62735
    
    - name: PANW-NM-000061
      label: The Palo Alto Networks security platform must prohibit the use of unencrypted protocols for network access to privileged accounts.
      meta:
        stig: ndm
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_ndm/2019-12-20/finding/V-62737
    
    - name: PANW-NM-000062
      label: The Palo Alto Networks security platform must enforce 24 hours/1 day as the minimum password lifetime.
      meta:
        stig: ndm
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_ndm/2019-12-20/finding/V-62739
    
    - name: PANW-NM-000063
      label: The Palo Alto Networks security platform must enforce a 60-day maximum password lifetime restriction.
      meta:
        stig: ndm
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_ndm/2019-12-20/finding/V-62741
    
    - name: PANW-NM-000069
      label: The Palo Alto Networks security platform must terminate management sessions after 10 minutes of inactivity except to fulfill documented and validated mission requirements.
      meta:
        stig: ndm
        severity: high
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_ndm/2019-12-20/finding/V-62743
    
    - name: PANW-NM-000075
      label: Administrators in the role of either Security Administrator or Cryptographic Administrator must not also have the role of Audit Administrator.
      meta:
        stig: ndm
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_ndm/2019-12-20/finding/V-62745
    
    - name: PANW-NM-000092
      label: The Palo Alto Networks security platform must automatically lock the account until the locked account is released by an administrator when three unsuccessful logon attempts in 15 minutes are exceeded.
      meta:
        stig: ndm
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_ndm/2019-12-20/finding/V-62747
    
    - name: PANW-NM-000096
      label: The Palo Alto Networks security platform must generate an immediate alert when allocated audit record storage volume reaches 75% of repository maximum audit record storage capacity.
      meta:
        stig: ndm
        severity: low
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_ndm/2019-12-20/finding/V-62749
    
    - name: PANW-NM-000097
      label: The Palo Alto Networks security platform must have alarms enabled.
      meta:
        stig: ndm
        severity: low
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_ndm/2019-12-20/finding/V-62751
    
    - name: PANW-NM-000098
      label: The Palo Alto Networks security platform must compare internal information system clocks at least every 24 hours with an authoritative time server.
      meta:
        stig: ndm
        severity: low
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_ndm/2019-12-20/finding/V-62753
    
    - name: PANW-NM-000099
      label: The Palo Alto Networks security platform must synchronize internal information system clocks to the authoritative time source when the time difference is greater than one second.
      meta:
        stig: ndm
        severity: low
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_ndm/2019-12-20/finding/V-62755
    
    - name: PANW-NM-000100
      label: The Palo Alto Networks security platform must be configured to synchronize internal information system clocks with the primary and secondary time sources located in different geographic regions using redundant authoritative time sources.
      meta:
        stig: ndm
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_ndm/2019-12-20/finding/V-62757
    
    - name: PANW-NM-000101
      label: The Palo Alto Networks security platform must record time stamps for audit records that can be mapped to Coordinated Universal Time (UTC) or Greenwich Mean Time (GMT).
      meta:
        stig: ndm
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_ndm/2019-12-20/finding/V-62759
    
    - name: PANW-NM-000110
      label: The Palo Alto Networks security platform must accept and verify Personal Identity Verification (PIV) credentials.
      meta:
        stig: ndm
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_ndm/2019-12-20/finding/V-62761
    
    - name: PANW-NM-000114
      label: The Palo Alto Networks security platform must allow the use of a temporary password for system logons with an immediate change to a permanent password.
      meta:
        stig: ndm
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_ndm/2019-12-20/finding/V-62763
    
    - name: PANW-NM-000117
      label: The Palo Alto Networks security platform must only allow the use of secure protocols that implement cryptographic mechanisms to protect the integrity of maintenance and diagnostic communications for nonlocal maintenance sessions.
      meta:
        stig: ndm
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_ndm/2019-12-20/finding/V-62765
    
    - name: PANW-NM-000118
      label: The Palo Alto Networks security platform must not use SNMP Versions 1 or 2.
      meta:
        stig: ndm
        severity: high
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_ndm/2019-12-20/finding/V-62767
    
    - name: PANW-NM-000128
      label: The Palo Alto Networks security platform must off-load audit records onto a different system or media than the system being audited.
      meta:
        stig: ndm
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_ndm/2019-12-20/finding/V-62769
    
    - name: PANW-NM-000131
      label: The Palo Alto Networks security platform must use automated mechanisms to alert security personnel to threats identified by authoritative sources (e.g., CTOs) and IAW CJCSM 6510.01B.
      meta:
        stig: ndm
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_ndm/2019-12-20/finding/V-62771
    
    - name: PANW-NM-000136
      label: The Palo Alto Networks security platform must employ centrally managed authentication server(s).
      meta:
        stig: ndm
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_ndm/2019-12-20/finding/V-62773
    
    - name: PANW-NM-000141
      label: The Palo Alto Networks security platform must use DoD-approved PKI rather than proprietary or self-signed device certificates.
      meta:
        stig: ndm
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_ndm/2019-12-20/finding/V-62777
    
    - name: PANW-NM-000142
      label: The Palo Alto Networks security platform must not use Password Profiles.
      meta:
        stig: ndm
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_ndm/2019-12-20/finding/V-62779
    
    - name: PANW-NM-000143
      label: The Palo Alto Networks security platform must not use the default admin account password.
      meta:
        stig: ndm
        severity: high
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_ndm/2019-12-20/finding/V-62781
    
    - name: PANW-NM-000144
      label: The Palo Alto Networks security platform must generate an audit log record when the Data Plane CPU utilization is 100%.
      meta:
        stig: ndm
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_ndm/2019-12-20/finding/V-62783
    
    - name: PANW-NM-000145
      label: The Palo Alto Networks security platform must authenticate Network Time Protocol sources.
      meta:
        stig: ndm
        severity: medium
      test: false
      fail_message: Click link for remediation instruction.
      pass_message: Validation successful
      documentation_link: https://www.stigviewer.com/stig/palo_alto_networks_ndm/2019-12-20/finding/V-62785
    